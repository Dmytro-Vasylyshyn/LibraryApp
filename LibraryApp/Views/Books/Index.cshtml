@model IEnumerable<LibraryApp.Models.Book>

<h2>Список книг</h2>

<form id="searchForm" method="get">
    <input type="text" id="searchTitle" placeholder="Назва книги" value="@ViewData["SearchTitle"]" />
    <input type="text" id="searchAuthor" placeholder="Автор" value="@ViewData["SearchAuthor"]" />
    <input type="text" id="searchGenre" placeholder="Жанр" value="@ViewData["SearchGenre"]" />
    <input type="submit" value="Пошук" />
</form>

<div id="booksContainer">
    @await Html.PartialAsync("_BooksList", Model) // Render the initial book list
</div>

@section Scripts {
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script>
        $(document).ready(function () {
            $('#searchForm').submit(function (e) {
                e.preventDefault(); // Prevent default form submission

                var title = $('#searchTitle').val();
                var author = $('#searchAuthor').val();
                var genre = $('#searchGenre').val();

                $.ajax({
                    url: '@Url.Action("Search", "Books")', // URL to the search action
                    type: 'GET',
                    data: { searchTitle: title, searchAuthor: author, searchGenre: genre },
                    success: function (result) {
                        $('#booksContainer').html(result); // Update the container with the result
                    },
                    error: function () {
                        alert('Сталася помилка під час пошуку книг.'); // Error handling
                    }
                });
            });
        });
    </script>
}
